#include "Core/Quantity/ColorSpace/spectral_data.h"

namespace ph
{

namespace spectral_data
{

namespace
{

/*
	The data represented here is generated by Brian Smits' Matlab scripts
	for "An RGB to Spectrum Conversion for Reflectances", with minor 
	modifications by Thomas Mansencal and Tzu-Chieh Chang.

	For emission, we do not use the data tailored towards illuminant like
	renderers such as pbrt-v3 and mitsuba, since we want consistent lighting
	behavior for materials and lights (most scene creation software use RGB
	values for users to adjust light color). Moreover, appleseed renderer
	reports (in their source code) that the aforementioned data gives an
	undesirable blue tint, which is likely due to the fact they use a D65
	illuminant as white rather than a constant spectrum as in the paper.

	From the reasons above, we use reflectance data for lights also; color 
	balance is expected to be performed on RGB or XYZ values.
*/

constexpr Array64R smits_linear_sRGB_to_spectrum_wavelengths_nm_data = 
{{
	3.80000000000000000000e+02_r, 3.86349206349206330000e+02_r, 3.92698412698412710000e+02_r, 
	3.99047619047619040000e+02_r, 4.05396825396825420000e+02_r, 4.11746031746031750000e+02_r, 
	4.18095238095238070000e+02_r, 4.24444444444444460000e+02_r, 4.30793650793650780000e+02_r, 
	4.37142857142857170000e+02_r, 4.43492063492063490000e+02_r, 4.49841269841269820000e+02_r, 
	4.56190476190476200000e+02_r, 4.62539682539682530000e+02_r, 4.68888888888888910000e+02_r, 
	4.75238095238095240000e+02_r, 4.81587301587301570000e+02_r, 4.87936507936507950000e+02_r, 
	4.94285714285714280000e+02_r, 5.00634920634920600000e+02_r, 5.06984126984126990000e+02_r, 
	5.13333333333333370000e+02_r, 5.19682539682539640000e+02_r, 5.26031746031746020000e+02_r, 
	5.32380952380952410000e+02_r, 5.38730158730158790000e+02_r, 5.45079365079365060000e+02_r, 
	5.51428571428571440000e+02_r, 5.57777777777777830000e+02_r, 5.64126984126984100000e+02_r, 
	5.70476190476190480000e+02_r, 5.76825396825396870000e+02_r, 5.83174603174603130000e+02_r, 
	5.89523809523809520000e+02_r, 5.95873015873015900000e+02_r, 6.02222222222222170000e+02_r, 
	6.08571428571428560000e+02_r, 6.14920634920634940000e+02_r, 6.21269841269841210000e+02_r, 
	6.27619047619047590000e+02_r, 6.33968253968253980000e+02_r, 6.40317460317460250000e+02_r, 
	6.46666666666666740000e+02_r, 6.53015873015873010000e+02_r, 6.59365079365079280000e+02_r, 
	6.65714285714285780000e+02_r, 6.72063492063492050000e+02_r, 6.78412698412698430000e+02_r, 
	6.84761904761904820000e+02_r, 6.91111111111111090000e+02_r, 6.97460317460317470000e+02_r, 
	7.03809523809523850000e+02_r, 7.10158730158730120000e+02_r, 7.16507936507936510000e+02_r, 
	7.22857142857142890000e+02_r, 7.29206349206349160000e+02_r, 7.35555555555555540000e+02_r, 
	7.41904761904761930000e+02_r, 7.48253968253968200000e+02_r, 7.54603174603174580000e+02_r, 
	7.60952380952380960000e+02_r, 7.67301587301587230000e+02_r, 7.73650793650793730000e+02_r, 
	7.80000000000000000000e+02_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_white_data = 
{{
	1.04153812413987560000e+00_r, 1.04153618264201750000e+00_r, 1.04154033032591500000e+00_r, 
	1.04153910471433610000e+00_r, 1.04149659648778000000e+00_r, 1.04153787545531730000e+00_r, 
	1.04154068758832150000e+00_r, 1.04153669014120350000e+00_r, 1.04154153380185010000e+00_r, 
	1.04154062575732010000e+00_r, 1.04153990651774020000e+00_r, 1.04154090875406680000e+00_r, 
	1.04154021361561530000e+00_r, 1.04153757622952980000e+00_r, 1.04154100099447850000e+00_r, 
	1.04154083789220640000e+00_r, 1.04154241868236270000e+00_r, 1.04153755710036110000e+00_r, 
	1.04154126090920850000e+00_r, 1.04153615182050440000e+00_r, 1.04149822982215890000e+00_r, 
	1.04144266201321130000e+00_r, 1.04136533492122930000e+00_r, 1.04128650374591940000e+00_r, 
	1.04121832515553290000e+00_r, 1.04116423208336380000e+00_r, 1.04108296917690610000e+00_r, 
	1.04102504932585790000e+00_r, 1.04099049451397850000e+00_r, 1.04096280925171780000e+00_r, 
	1.04096888495013170000e+00_r, 1.04099240629837400000e+00_r, 1.04098674278449880000e+00_r, 
	1.04099868219951810000e+00_r, 1.04100574489644580000e+00_r, 1.04102168313943210000e+00_r, 
	1.04104389347682940000e+00_r, 1.04105852080270480000e+00_r, 1.04107579294301970000e+00_r, 
	1.04108833498352030000e+00_r, 1.04110316235825410000e+00_r, 1.04111401544157920000e+00_r, 
	1.04112401832686040000e+00_r, 1.04115704922418570000e+00_r, 1.04117075668960600000e+00_r, 
	1.04119874463040010000e+00_r, 1.04122485322510010000e+00_r, 1.04122929926383170000e+00_r, 
	1.04124918704326450000e+00_r, 1.04126526337760090000e+00_r, 1.04128804589334420000e+00_r, 
	1.04130204489820730000e+00_r, 1.04135940592439450000e+00_r, 1.04142762736433410000e+00_r, 
	1.04138822488390500000e+00_r, 1.04133312431475990000e+00_r, 1.04133744078712390000e+00_r, 
	1.04132392186410040000e+00_r, 1.04135165372865330000e+00_r, 1.04142770505296010000e+00_r, 
	1.04149967291370630000e+00_r, 1.04151877703354570000e+00_r, 1.04151271642466160000e+00_r, 
	1.04153350895449990000e+00_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_cyan_data =
{{
	9.83312806693974580000e-01_r, 9.79892600629730710000e-01_r, 9.77143673864986240000e-01_r, 
	9.74494460754964710000e-01_r, 9.72648097600503300000e-01_r, 9.75677205004770180000e-01_r, 
	9.78445236949973650000e-01_r, 9.84964117018361400000e-01_r, 9.94178575600506600000e-01_r, 
	1.00895623816403250000e+00_r, 1.01943415178935390000e+00_r, 1.03152962427227800000e+00_r, 
	1.03153247779279570000e+00_r, 1.03152712674769710000e+00_r, 1.03149697389376340000e+00_r, 
	1.03152289473624400000e+00_r, 1.03153204724602280000e+00_r, 1.03153082524847850000e+00_r, 
	1.03153083006609550000e+00_r, 1.03152922151289420000e+00_r, 1.03153369001101280000e+00_r, 
	1.03153274123819030000e+00_r, 1.03153273650967140000e+00_r, 1.03153475743964450000e+00_r, 
	1.03153448182938550000e+00_r, 1.03153307317741990000e+00_r, 1.03153177683512070000e+00_r, 
	1.03153216673498970000e+00_r, 1.03153367335201930000e+00_r, 1.03153205786863780000e+00_r, 
	1.03153333950473810000e+00_r, 1.02455054753766640000e+00_r, 7.97587789774992340000e-01_r, 
	5.12278080574897100000e-01_r, 2.43301251354074100000e-01_r, 5.56334253291052020000e-02_r, 
	1.53090856162829690000e-06_r, -2.33182299920475790000e-07_r, 1.22728216478407150000e-13_r, 
	3.29727596776879790000e-06_r, 9.86356831936957560000e-06_r, 9.29140556159280260000e-06_r, 
	8.24934410538491480000e-07_r, 3.83810766803327490000e-06_r, 1.58885406398162620000e-05_r, 
	5.10849427041298880000e-07_r, 5.19058972366440160000e-06_r, 5.02202569426304920000e-05_r, 
	2.36369557186227870000e-05_r, 9.00131982176093260000e-05_r, 1.09861655131520810000e-04_r, 
	2.03732657648314580000e-04_r, 5.21467039146049970000e-04_r, 1.40311602286123520000e-02_r, 
	1.09203523685994300000e-02_r, 8.23002659002154170000e-03_r, 5.28285598848282720000e-03_r, 
	2.64748302084528080000e-03_r, 1.50658460430060660000e-04_r, 7.26513272926603000000e-04_r, 
	4.48428409469222430000e-04_r, 1.84909258095930670000e-04_r, 1.06853639505274730000e-04_r, 
	2.04477952590370520000e-05_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_magenta_data =
{{
	9.14164103149435860000e-01_r, 9.20983521523765610000e-01_r, 9.18828987352176220000e-01_r, 
	9.44417635426834660000e-01_r, 9.83720694793725700000e-01_r, 9.95745331765411470000e-01_r, 
	9.99995835283986170000e-01_r, 9.99848587092424860000e-01_r, 9.98884501567955050000e-01_r, 
	9.99997612557003370000e-01_r, 9.99972261892699830000e-01_r, 9.99973753102886500000e-01_r, 
	9.99919352919497410000e-01_r, 9.99703306353703300000e-01_r, 9.91638996221283710000e-01_r, 
	9.86987302372944080000e-01_r, 8.47756976262773470000e-01_r, 6.61375014974124210000e-01_r, 
	3.60062143695366320000e-01_r, 1.50850633401564520000e-01_r, 8.06657861535531320000e-03_r, 
	6.70546279322947750000e-04_r, 3.64655061356769510000e-03_r, 4.47324580179195300000e-03_r, 
	3.43989244857811900000e-03_r, 2.12480460085567870000e-03_r, 5.13623207420060150000e-03_r, 
	2.59653409884208490000e-14_r, 2.03765527654331540000e-04_r, 1.50111349937426250000e-02_r, 
	3.41017143264236160000e-02_r, 2.62690376029444730000e-01_r, 4.95828505523634390000e-01_r, 
	6.66352607336410550000e-01_r, 7.70032160239660370000e-01_r, 9.04668685438029590000e-01_r, 
	9.77751652482811820000e-01_r, 9.95419540188425040000e-01_r, 9.99990891617798640000e-01_r, 
	9.87538516190064500000e-01_r, 9.99950653014430870000e-01_r, 9.99877429768354480000e-01_r, 
	9.99991035152757000000e-01_r, 9.92198256437513360000e-01_r, 9.94270515207434700000e-01_r, 
	9.93891884653326340000e-01_r, 9.50025886367286910000e-01_r, 9.29413769337980480000e-01_r, 
	9.49927158984499090000e-01_r, 9.32385879736651210000e-01_r, 9.16909908768006270000e-01_r, 
	8.98176536615435510000e-01_r, 8.79765358028646970000e-01_r, 8.70867218704914010000e-01_r, 
	8.61682800510794040000e-01_r, 8.54818988960220460000e-01_r, 8.53440146356928000000e-01_r, 
	8.52587021690221820000e-01_r, 8.50353495395752450000e-01_r, 8.49466575654235110000e-01_r, 
	8.49142753387603810000e-01_r, 8.51249979471286220000e-01_r, 8.50023864999662870000e-01_r, 
	8.50334076256098030000e-01_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_yellow_data =
{{
	5.21068321523098650000e-03_r, 7.33701294164390560000e-15_r, 2.10199812093391120000e-04_r, 
	3.75050344299858620000e-04_r, 3.30689825006613700000e-06_r, 1.96321468374647400000e-04_r, 
	1.96039328486045940000e-04_r, 1.91170728722050990000e-03_r, 8.56994602552681170000e-03_r, 
	1.46443733008003590000e-02_r, 2.41361582417869560000e-02_r, 4.07108073670690160000e-02_r, 
	7.33955889737291230000e-02_r, 1.23298849824363480000e-01_r, 1.90018261219975370000e-01_r, 
	2.78198248779204850000e-01_r, 3.80020956956709010000e-01_r, 4.92496982597480320000e-01_r, 
	6.07372786510051440000e-01_r, 7.25097981256400130000e-01_r, 8.40080050342658650000e-01_r, 
	9.50679312773086590000e-01_r, 1.00900755232005260000e+00_r, 1.02947658672343030000e+00_r, 
	1.02991807597465760000e+00_r, 1.02991672100722800000e+00_r, 1.02987977468351620000e+00_r, 
	1.02987611583771630000e+00_r, 1.02989926789170070000e+00_r, 1.02991672479896890000e+00_r, 
	1.02991893528144800000e+00_r, 1.02992008169115110000e+00_r, 1.02992076344114290000e+00_r, 
	1.02992061816922290000e+00_r, 1.02992183727360080000e+00_r, 1.02990890245921250000e+00_r, 
	1.02991938978165480000e+00_r, 1.02991757487953550000e+00_r, 1.02987159341507330000e+00_r, 
	1.02991907524663180000e+00_r, 1.02991792123601790000e+00_r, 1.02991095559556990000e+00_r, 
	1.02979087570077570000e+00_r, 1.02990396310141730000e+00_r, 1.02991565593361160000e+00_r, 
	1.02981966653538630000e+00_r, 1.02991735891054550000e+00_r, 1.02947487655814340000e+00_r, 
	1.02988846734673900000e+00_r, 1.02991596061252280000e+00_r, 1.02944064650793690000e+00_r, 
	1.02965847442050370000e+00_r, 1.02964574620246550000e+00_r, 1.02945933409545500000e+00_r, 
	1.02973228136901440000e+00_r, 1.02936011871023920000e+00_r, 1.02900635068286190000e+00_r, 
	1.02971820120175920000e+00_r, 1.02961495614926490000e+00_r, 1.02836531593849020000e+00_r, 
	1.02801683611722150000e+00_r, 1.02751947543369050000e+00_r, 1.02908693199457410000e+00_r, 
	1.02967486574988020000e+00_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_red_data =
{{
	1.45676976553854200000e-01_r, 1.42918526402727480000e-01_r, 1.42765224066877390000e-01_r, 
	1.42976504637793880000e-01_r, 1.42592835539195050000e-01_r, 1.36562987076759460000e-01_r, 
	1.24747608082521030000e-01_r, 1.02084582528404290000e-01_r, 6.83039681064864370000e-02_r, 
	1.14272076410557170000e-02_r, 1.65011314199645100000e-04_r, 5.24969292481553000000e-04_r, 
	1.45979305431961910000e-05_r, 8.67839567752163450000e-05_r, 6.70781877743359400000e-05_r, 
	4.64917292429950500000e-05_r, 1.00339357316417410000e-04_r, 6.81483390844173090000e-05_r, 
	1.87624386309009910000e-04_r, 8.69311083521173700000e-05_r, 8.83406104827955120000e-05_r, 
	1.20668032616011440000e-05_r, 1.32129232000011140000e-08_r, 1.79794590376980420000e-05_r, 
	1.20029915551350670000e-04_r, 5.74339747939356380000e-05_r, 5.92328788824730830000e-05_r, 
	9.05176521374326250000e-05_r, 3.30012507663901560000e-04_r, 2.03407820580370210000e-05_r, 
	1.03983560020504130000e-04_r, 2.49240242956925150000e-02_r, 3.28392061284717980000e-01_r, 
	6.34075701709978290000e-01_r, 8.53163457605034650000e-01_r, 9.99606489112980670000e-01_r, 
	9.99946440893211270000e-01_r, 9.99859178303225350000e-01_r, 9.99744596806674160000e-01_r, 
	9.99881625874013410000e-01_r, 9.99717794252571460000e-01_r, 9.99700572014759480000e-01_r, 
	9.99683907548992500000e-01_r, 9.99637558149860880000e-01_r, 9.99506387342879550000e-01_r, 
	9.99943798637598750000e-01_r, 9.99927938298224790000e-01_r, 9.89299749357225760000e-01_r, 
	9.81786736157974960000e-01_r, 9.93774999960943100000e-01_r, 9.99198902524012560000e-01_r, 
	9.95276074100475800000e-01_r, 9.87866020887426700000e-01_r, 9.92508870704712830000e-01_r, 
	9.94196314227987600000e-01_r, 9.96223077681222540000e-01_r, 9.99999999997995380000e-01_r, 
	9.97396655777947120000e-01_r, 9.91654437885538090000e-01_r, 9.87218049299077300000e-01_r, 
	9.86431981410839320000e-01_r, 9.83191967390396160000e-01_r, 9.72780824404135820000e-01_r, 
	9.64269539135083510000e-01_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_green_data =
{{
	5.45191193305645900000e-04_r, 3.27092226236652640000e-04_r, 1.25511156213588420000e-04_r, 
	1.23675407860090060000e-04_r, 1.51187498262012920000e-03_r, 1.78354708150938420000e-05_r, 
	2.33459829211690730000e-06_r, 1.75139148316655340000e-06_r, 1.24338671463595540000e-06_r, 
	9.28621124602138640000e-07_r, -1.96129882820694770000e-09_r, 1.26610074506483540000e-06_r, 
	8.21362166544825630000e-07_r, 5.76963523529011590000e-03_r, 9.24368974337928110000e-02_r, 
	2.36415130851245630000e-01_r, 4.14332115326502050000e-01_r, 6.02048343982853900000e-01_r, 
	7.76512461859883760000e-01_r, 9.13731428483590240000e-01_r, 9.98039731048399270000e-01_r, 
	9.99900897060829190000e-01_r, 9.99994988452497010000e-01_r, 9.99998546951554320000e-01_r, 
	9.99997967391530680000e-01_r, 9.99996473323202410000e-01_r, 9.99999201999365540000e-01_r, 
	9.99998544975275290000e-01_r, 1.00000062820762260000e+00_r, 9.99797598525815960000e-01_r, 
	9.52355205106728550000e-01_r, 8.37678681796504290000e-01_r, 6.78560709018262600000e-01_r, 
	5.02744858893964810000e-01_r, 3.28904644567157790000e-01_r, 1.77753541532892250000e-01_r, 
	6.47842253884522430000e-02_r, 2.65223002432445070000e-05_r, 1.67181974074746830000e-06_r, 
	5.48153340058921130000e-07_r, 1.44578900204000990000e-06_r, 1.40395237078830280000e-05_r, 
	8.23793090962143810000e-06_r, 1.67390320063298680000e-07_r, 2.10728003203000670000e-06_r, 
	3.35788130386115160000e-05_r, 4.70938399384571160000e-06_r, 7.47092427238332800000e-07_r, 
	1.30487464735764070000e-05_r, 9.35975350414889290000e-05_r, 4.86354023913719570000e-06_r, 
	-1.38261417384488720000e-08_r, 1.16716876591229940000e-05_r, 4.35332591028352210000e-04_r, 
	1.23740318410162430000e-03_r, 6.39450615622269480000e-04_r, 2.47124064183113990000e-03_r, 
	4.15804351938179640000e-03_r, 8.79551186156262570000e-03_r, 9.35047051925706060000e-03_r, 
	1.00133005351238800000e-02_r, 1.09862771303499260000e-02_r, 1.20043285576356230000e-02_r, 
	1.30191208309500660000e-02_r
}};

constexpr Array64R smits_linear_sRGB_to_spectrum_blue_data =
{{
	9.99967716440600010000e-01_r, 9.99623380654101720000e-01_r, 9.93877878743092640000e-01_r, 
	9.91988133757373160000e-01_r, 9.96499620288656910000e-01_r, 9.99856722618104100000e-01_r, 
	9.99999895097500200000e-01_r, 9.99999107142760300000e-01_r, 9.99998823462948440000e-01_r, 
	9.99865341798838130000e-01_r, 9.99704408151248060000e-01_r, 9.99573585236281810000e-01_r, 
	9.96702861864495300000e-01_r, 9.53907917750773660000e-01_r, 8.85751002727261930000e-01_r, 
	7.94277555728474800000e-01_r, 6.88066558704716450000e-01_r, 5.70581764825636490000e-01_r, 
	4.48006657405307650000e-01_r, 3.35456166846020980000e-01_r, 2.30119133444142280000e-01_r, 
	1.33944030213599020000e-01_r, 5.29563771142602950000e-02_r, 2.28091601720727820000e-03_r, 
	3.91105479258940790000e-06_r, 6.09416142029889360000e-06_r, 1.13206863457115950000e-06_r, 
	2.23104767806264760000e-05_r, 1.53330844897813650000e-03_r, 1.95746896808676050000e-04_r, 
	2.34646680765070860000e-04_r, 1.26584492297909800000e-07_r, 1.14491749414469270000e-16_r, 
	3.33621676794973890000e-03_r, 1.87405427936784660000e-03_r, 5.23326490617584490000e-03_r, 
	6.72529419856280480000e-03_r, 1.51143787352214670000e-02_r, 2.32811182197286000000e-02_r, 
	2.93545138897050550000e-02_r, 3.48557364369867090000e-02_r, 3.93152283826307610000e-02_r, 
	4.28957208906553260000e-02_r, 4.38183644578354830000e-02_r, 4.68644689748329570000e-02_r, 
	4.99235164363836870000e-02_r, 5.22769828338006600000e-02_r, 5.38750888306459630000e-02_r, 
	5.09174316433060880000e-02_r, 4.75795968510250230000e-02_r, 4.50527967411534090000e-02_r, 
	4.27198367533816530000e-02_r, 4.02568181419432140000e-02_r, 3.79239531390346480000e-02_r, 
	3.64860355909615230000e-02_r, 3.31371445152691680000e-02_r, 2.97302362323406750000e-02_r, 
	2.64110208897839830000e-02_r, 2.29455033756498260000e-02_r, 2.01334192197391080000e-02_r, 
	1.86519782436731130000e-02_r, 1.70429480123294280000e-02_r, 1.53468366314872750000e-02_r, 
	1.03299589082096830000e-02_r
}};

}// end namespace anonymous

const Array64R& smits_linear_sRGB_to_spectrum_wavelengths_nm()
{
	return smits_linear_sRGB_to_spectrum_wavelengths_nm_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_white()
{
	return smits_linear_sRGB_to_spectrum_white_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_cyan()
{
	return smits_linear_sRGB_to_spectrum_cyan_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_magenta()
{
	return smits_linear_sRGB_to_spectrum_magenta_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_yellow()
{
	return smits_linear_sRGB_to_spectrum_yellow_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_red()
{
	return smits_linear_sRGB_to_spectrum_red_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_green()
{
	return smits_linear_sRGB_to_spectrum_green_data;
}

const Array64R& smits_linear_sRGB_to_spectrum_blue()
{
	return smits_linear_sRGB_to_spectrum_blue_data;
}

}// end namespace spectral_data

}// end namespace ph